import manifest from "#content/manifest";
import { queryCollectionWithEvent } from "#sitemap/content-v3-nitro-path";
export default async (e) => {
  const collections = [];
  for (const collection in manifest) {
    if ("path" in manifest[collection].fields) {
      collections.push(collection);
    }
  }
  const contentList = [];
  for (const collection of collections) {
    contentList.push(queryCollectionWithEvent(e, collection).select("id", "path", "title").where("path", "IS NOT NULL").all());
  }
  const results = await Promise.all(contentList);
  return results.flat().map((d) => {
    return {
      link: d.path,
      title: d.title,
      file: d.id
    };
  });
};
